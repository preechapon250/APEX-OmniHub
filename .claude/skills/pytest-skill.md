---name: pytest-architectdescription: "Generates production-grade pytest suites with 90%+ guaranteed coverage. Triggers: generate tests, write tests for [file], fix coverage, test [function]. Produces: idempotent, parametrized test files using APEX standards."license: "Proprietary - APEX Business Systems Ltd."---# Pytest Architect**Mission**: Eliminate "Test & Lint" failures by generating first-pass passing tests with high coverage.## Contract**Input**: Python source file (`.py`) + optional context (Pydantic models, DB schema).**Output**: `tests/test_[name].py` matching the source structure.**Success**: `pytest` execution returns green with >90% coverage report.## Decision Tree**What are we testing?**1.  **FastAPI/Routes?** ? **Section A**: Use `TestClient` + `conftest.py` overrides.2.  **Pydantic Models?** ? **Section B**: Verify field validation + serialization.3.  **Business Logic?** ? **Section C**: Pure functions + Parametrization.4.  **Database/Redis?** ? **Section D**: Use `pytest-mock` or Docker mocks (NEVER live DB).---## Section A: API Routes (FastAPI)**Correct Approach**:```python@pytest.mark.asyncioasync def test_create_item(client: AsyncClient, mock_db_session):    # ARRANGE    payload = {"name": "Test Item", "price": 10.5}        # ACT    response = await client.post("/items/", json=payload)        # ASSERT    assert response.status_code == 201    assert response.json()["name"] == "Test Item"